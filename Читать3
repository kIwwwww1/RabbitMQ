–û—Ç–ª–∏—á–Ω–æ üí™ ‚Äî —Ç–µ–ø–µ—Ä—å —Ç—ã –ø–µ—Ä–µ—Ö–æ–¥–∏—à—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é –ø–æ–Ω–∏–º–∞–Ω–∏—è RabbitMQ ‚Äî **–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥–µ–π –∏ –≤–µ–µ—Ä–Ω–æ–µ (fanout) —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** —Å–æ–æ–±—â–µ–Ω–∏–π.
–≠—Ç–æ —É–∂–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ ‚Äú–º–Ω–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–æ–≤‚Äù, –∞ **–ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π —Å—Ä–∞–∑—É –≤–æ –≤—Å–µ –æ—á–µ—Ä–µ–¥–∏**, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –ø–æ–¥–ø–∏—Å—á–∏–∫ –ø–æ–ª—É—á–∏–ª —Å–≤–æ—é –∫–æ–ø–∏—é.

---

# üß≠ –ß—Ç–æ –∑–Ω–∞—á–∏—Ç "–≤–µ–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ" (fanout)

–¢–∏–ø –æ–±–º–µ–Ω–Ω–∏–∫–∞ (**exchange type**) = `fanout`.

üîπ **–°—É—Ç—å:**
–°–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –≤ `fanout`-exchange, –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤–æ **–≤—Å–µ –æ—á–µ—Ä–µ–¥–∏**, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —ç—Ç–æ–º—É exchange.
Routing key **–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è** ‚Äî –≤—Å–µ, –∫—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω, –ø–æ–ª—É—á–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.

üìä **–°—Ö–µ–º–∞:**

```
                +--------------------+
Producer ‚Üí ‚Üí ‚Üí  |   fanout exchange  |
                +--------------------+
                   ‚Üô        ‚Üì        ‚Üò
                Queue A   Queue B   Queue C
                   ‚Üì        ‚Üì        ‚Üì
                ConsumerA ConsumerB ConsumerC
```

–ö–∞–∂–¥—ã–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç **—Å–≤–æ—é –∫–æ–ø–∏—é** —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥—Ä—É–≥–∏—Ö.

---

# ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —à–∞–≥–∞–º

1. **Producer** –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ `fanout` exchange.
   ‚Üí `routing_key` –Ω–µ –≤–∞–∂–µ–Ω (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º `''`).

2. **Exchange** –¥–µ–ª–∞–µ—Ç –∫–æ–ø–∏—é —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è **–∫–∞–∂–¥–æ–π –æ—á–µ—Ä–µ–¥–∏**, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–π –∫ –Ω–µ–º—É.

3. **Consumer** –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ **—Å–≤–æ–µ–π –æ—á–µ—Ä–µ–¥–∏** (–Ω–µ –¥–µ–ª—è—Ç –æ—á–µ—Ä–µ–¥—å, –∫–∞–∫ –≤ `direct`-—Å—Ü–µ–Ω–∞—Ä–∏–∏).

4. **–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç—Å—è** ‚Äî –µ–≥–æ –æ—á–µ—Ä–µ–¥—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–µ—Å–ª–∏ durable=true), –∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –æ–Ω –≤—Å—ë –ø–æ–ª—É—á–∏—Ç.

---

# üß∞ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ Python (`pika`)

## 1. Producer (–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å)

```python
# publisher_fanout.py
import pika

conn = pika.BlockingConnection(pika.ConnectionParameters('localhost'))
ch = conn.channel()

# —Å–æ–∑–¥–∞–µ–º fanout exchange
ch.exchange_declare(exchange='logs_fanout', exchange_type='fanout', durable=True)

message = "Broadcast: System update!"
ch.basic_publish(
    exchange='logs_fanout',
    routing_key='',  # ignored
    body=message,
    properties=pika.BasicProperties(delivery_mode=2)
)
print(f" [x] Sent: {message}")

conn.close()
```

---

## 2. Consumers (–Ω–µ—Å–∫–æ–ª—å–∫–æ)

### consumer_1.py

```python
import pika

conn = pika.BlockingConnection(pika.ConnectionParameters('localhost'))
ch = conn.channel()

ch.exchange_declare(exchange='logs_fanout', exchange_type='fanout', durable=True)

# —Å–æ–∑–¥–∞–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –æ—á–µ—Ä–µ–¥—å –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞
q = ch.queue_declare(queue='queue_A', durable=True).method.queue

# –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –µ—ë –∫ fanout exchange
ch.queue_bind(exchange='logs_fanout', queue=q)

def callback(ch, method, props, body):
    print("[Consumer A] Got:", body.decode())
    ch.basic_ack(method.delivery_tag)

ch.basic_consume(queue=q, on_message_callback=callback)
print(" [*] Consumer A waiting for messages")
ch.start_consuming()
```

---

### consumer_2.py

```python
import pika

conn = pika.BlockingConnection(pika.ConnectionParameters('localhost'))
ch = conn.channel()

ch.exchange_declare(exchange='logs_fanout', exchange_type='fanout', durable=True)

# –≤—Ç–æ—Ä–∞—è –æ—á–µ—Ä–µ–¥—å
q = ch.queue_declare(queue='queue_B', durable=True).method.queue
ch.queue_bind(exchange='logs_fanout', queue=q)

def callback(ch, method, props, body):
    print("[Consumer B] Got:", body.decode())
    ch.basic_ack(method.delivery_tag)

ch.basic_consume(queue=q, on_message_callback=callback)
print(" [*] Consumer B waiting for messages")
ch.start_consuming()
```

---

–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏:

1. `consumer_1.py`
2. `consumer_2.py`
3. –ø–æ—Ç–æ–º `publisher_fanout.py`

üîπ –†–µ–∑—É–ª—å—Ç–∞—Ç:

```
[Consumer A] Got: Broadcast: System update!
[Consumer B] Got: Broadcast: System update!
```

–û–±–∞ –ø–æ–ª—É—á–∏–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚úÖ

---

# üß© –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É fanout –∏ direct

| –°–≤–æ–π—Å—Ç–≤–æ             | `direct`                                     | `fanout`                               |
| -------------------- | -------------------------------------------- | -------------------------------------- |
| Routing key          | –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É              | –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è                           |
| –ö–æ–ª-–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π   | —Ç–æ–ª—å–∫–æ —Ç–µ –æ—á–µ—Ä–µ–¥–∏, —á—å–∏ binding key —Å–æ–≤–ø–∞–¥–∞—é—Ç | –≤—Å–µ –æ—á–µ—Ä–µ–¥–∏, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ exchange    |
| –¢–∏–ø –∑–∞–¥–∞—á            | –≤—ã–±–æ—Ä–æ—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (point-to-point)         | —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ (broadcast) |
| –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è | —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏          | —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º           |

---

# üß± Fanout —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ—á–µ—Ä–µ–¥—è–º–∏ (–ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É:

| –û—á–µ—Ä–µ–¥—å               | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                        |
| --------------------- | --------------------------------- |
| `email_notifications` | —Å–µ—Ä–≤–∏—Å, —Ä–∞—Å—Å—ã–ª–∞—é—â–∏–π –ø–∏—Å—å–º–∞        |
| `sms_notifications`   | —Å–µ—Ä–≤–∏—Å SMS                        |
| `push_notifications`  | –ø—É—à–∏ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ã                  |
| `logging`             | —Å–µ—Ä–≤–∏—Å, –ø–∏—à—É—â–∏–π –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π |

–í—Å–µ –æ–Ω–∏ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –æ–¥–∏–Ω exchange:

```
Exchange (fanout)
 ‚îú‚îÄ Queue: email_notifications ‚Üí Email Service
 ‚îú‚îÄ Queue: sms_notifications   ‚Üí SMS Service
 ‚îú‚îÄ Queue: push_notifications  ‚Üí Push Service
 ‚îî‚îÄ Queue: logging             ‚Üí Logger Service
```

–ü—Ä–æ–¥—é—Å–µ—Ä –ø—É–±–ª–∏–∫—É–µ—Ç –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ (‚ÄúUser registered‚Äù), –∞ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ—é –∫–æ–ø–∏—é.

---

# üß† –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ–∏—à–∫–∏

### üî∏ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å **–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏**, –µ—Å–ª–∏ –∫–æ–Ω—Å—å—é–º–µ—Ä –ø—Ä–æ—Å—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å broadcast ‚Äú–Ω–∞ –≤—Ä–µ–º—è‚Äù.

```python
q = ch.queue_declare(queue='', exclusive=True).method.queue
```

–¢–∞–∫–∞—è –æ—á–µ—Ä–µ–¥—å –∏—Å—á–µ–∑–∞–µ—Ç, –∫–æ–≥–¥–∞ consumer –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è.

### üî∏ Durable –∏ Persistent

–ß—Ç–æ–±—ã –æ—á–µ—Ä–µ–¥—å –∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º–∏ RabbitMQ:

```python
ch.exchange_declare(exchange='logs_fanout', exchange_type='fanout', durable=True)
ch.queue_declare(queue='queue_A', durable=True)
ch.basic_publish(..., properties=pika.BasicProperties(delivery_mode=2))
```

### üî∏ Fanout + Direct –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–ß–∞—Å—Ç–æ –¥–µ–ª–∞—é—Ç —Ç–∞–∫:

* `fanout` exchange —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Äú—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö‚Äù `direct`-exchange.
* –¢–µ —É–∂–µ —Ä–µ—à–∞—é—Ç, –∫–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã.

---

# üöÄ Fanout vs –ù–µ—Å–∫–æ–ª—å–∫–æ consumers –æ–¥–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏

| –¶–µ–ª—å                                                                                                 | –ö–∞–∫ –ª—É—á—à–µ                                      |
| ---------------------------------------------------------------------------------------------------- | ---------------------------------------------- |
| –•–æ—á—É **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å** –∑–∞–¥–∞—á–∏ –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–æ—Ä–∫–µ—Ä–∞–º–∏ (–∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω) | üß© **–û–¥–Ω–∞ –æ—á–µ—Ä–µ–¥—å, –Ω–µ—Å–∫–æ–ª—å–∫–æ consumers**       |
| –•–æ—á—É **—Ä–∞—Å—Å—ã–ª–∞—Ç—å** —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º (–∫–∞–∂–¥—ã–π –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ø–∏—é)                                | üì£ **Fanout exchange —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ—á–µ—Ä–µ–¥—è–º–∏** |

---

# üí° –ò—Ç–æ–≥–æ ‚Äî –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

| –ü–∞—Ä–∞–º–µ—Ç—Ä                         | –ó–Ω–∞—á–µ–Ω–∏–µ                                                |
| -------------------------------- | ------------------------------------------------------- |
| Exchange type                    | `fanout`                                                |
| Routing key                      | –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è                                         |
| –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤           | –≤—Å–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏                                 |
| –°–∫–æ–ª—å–∫–æ –æ—á–µ—Ä–µ–¥–µ–π –º–æ–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å | —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ                                          |
| –¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π                | Broadcast, pub/sub, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è                         |
| –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å                       | durable exchange + durable queues + persistent messages |

---

–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É —Ç–µ–±–µ —Å—Ö–µ–º—É —Å **–Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ fanout exchange**, –≥–¥–µ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –≤ —Ä–∞–∑–Ω—ã–µ –≥—Ä—É–ø–ø—ã –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ª–æ–≥–∏)?
–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫ **—Å–æ–µ–¥–∏–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ exchange –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º** ‚Äî ‚Äúexchange to exchange bindings‚Äù.
